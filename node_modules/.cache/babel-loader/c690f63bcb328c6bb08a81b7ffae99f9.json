{"ast":null,"code":"var _jsxFileName = \"/Users/wangchuang/files/react_antd/antd-demo-ts/src/pages/testSetup/setup.tsx\";\nimport React, { Component } from 'react';\nimport './setup.less';\n\nfunction SetupItem(item) {\n  console.log(\"data----\", item);\n  const {\n    length,\n    idx,\n    data\n  } = item;\n  const style = {\n    width: `${100 / (length - 1)}%`\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"setup-item\",\n    style: style,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 11,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cricle\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 13,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"item-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 14,\n      columnNumber: 7\n    }\n  }, data.secProgress || ''), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"item-tips\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 15,\n      columnNumber: 7\n    }\n  }, data.secTips || '')), idx !== length - 1 ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"setup-line\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 18,\n      columnNumber: 28\n    }\n  }) : null);\n}\n\nfunction leftBtnShow(l, cur) {\n  return Boolean(l > 3 && cur > 1);\n}\n\nfunction rightBtnShow(l, cur) {\n  return Boolean(l > 3 && cur < l - 2);\n}\n\nexport default class Setup extends Component {\n  constructor(props) {\n    super(props);\n\n    this.arrowClick = (direction, isShow) => {\n      if (!isShow) return;\n      let {\n        currentIndex\n      } = this.state;\n      let {\n        progress\n      } = this.props;\n      console.log('点击箭头', direction, currentIndex);\n\n      if (currentIndex <= 1 && direction === 'left' || currentIndex >= progress.length - 2 && direction === 'right') {\n        return;\n      }\n\n      currentIndex = direction === 'left' ? currentIndex - 1 : currentIndex + 1;\n      this.setState({\n        currentIndex\n      }, () => {\n        console.log('修改后的数据', this.state);\n        this.processSetupData(progress);\n      });\n    };\n\n    this.processSetupData = list => {\n      const setupList = [...list];\n\n      if (setupList && setupList.length) {\n        let currentIndex = this.state.currentIndex;\n\n        if (currentIndex === null) {\n          currentIndex = setupList.findIndex(item => item.current === 'Y');\n        }\n\n        const startIndex = currentIndex - 1 < 0 ? 0 : currentIndex - 1;\n        const nowArr = setupList.slice(startIndex, currentIndex + 2);\n        console.log('----处理数据', currentIndex, nowArr); // 根据当前值获取最近数据\n\n        this.setState({\n          currentIndex,\n          process: nowArr\n        });\n      }\n    };\n\n    this.state = {\n      title: '测试进度',\n      currentIndex: null,\n      processCopy: [],\n      process: []\n    };\n  }\n\n  componentWillUpdate(nextProps) {\n    console.log('------', nextProps, this.props);\n\n    if (nextProps.progress !== this.props.progress) {\n      const {\n        progress\n      } = nextProps;\n      this.setState({\n        processCopy: process\n      }); // 备份（可以不用，props中有数据）\n\n      this.processSetupData(progress);\n    }\n  }\n\n  render() {\n    const {\n      process,\n      currentIndex\n    } = this.state;\n    let {\n      progress: progressResouce\n    } = this.props;\n    const leftArrowShaw = leftBtnShow(progressResouce.length, currentIndex);\n    const rightArrowShaw = rightBtnShow(progressResouce.length, currentIndex);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"setup-wrap\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: `arrow ${leftArrowShaw ? 'arrow-left' : ''}`,\n      onClick: () => {\n        this.arrowClick('left', leftArrowShaw);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"setup-bar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }\n    }, process && process.length ? process.map((item, idx) => {\n      return /*#__PURE__*/React.createElement(SetupItem, {\n        length: process.length,\n        idx: idx,\n        key: idx,\n        data: item,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 20\n        }\n      });\n    }) : null), /*#__PURE__*/React.createElement(\"div\", {\n      className: `arrow ${rightArrowShaw ? 'arrow-right' : ''}`,\n      onClick: () => {\n        this.arrowClick('right', rightArrowShaw);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 11\n      }\n    }));\n  }\n\n}","map":{"version":3,"sources":["/Users/wangchuang/files/react_antd/antd-demo-ts/src/pages/testSetup/setup.tsx"],"names":["React","Component","SetupItem","item","console","log","length","idx","data","style","width","secProgress","secTips","leftBtnShow","l","cur","Boolean","rightBtnShow","Setup","constructor","props","arrowClick","direction","isShow","currentIndex","state","progress","setState","processSetupData","list","setupList","findIndex","current","startIndex","nowArr","slice","process","title","processCopy","componentWillUpdate","nextProps","render","progressResouce","leftArrowShaw","rightArrowShaw","map"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport './setup.less';\n\nfunction SetupItem(item: any) {\n  console.log(\"data----\", item);\n  const { length, idx, data } = item;\n  const style = {\n    width: `${100 / (length - 1)}%`\n  };\n  return (\n  <div className=\"setup-item\" style={style}>\n    {/* 对应每个点的圆圈，这里根据状态添加类名，样式在class样式中定义 */}\n    <div className=\"cricle\">\n      <div className=\"item-label\">{data.secProgress || ''}</div>\n      <div className=\"item-tips\">{data.secTips || ''}</div>\n    </div>\n    {/* 进度条的线条，具体样自己调整，最后一部不显示已经控制 */}\n    { idx !== length - 1 ? <div className=\"setup-line\" /> : null}\n  </div>\n  )\n}\n\nfunction leftBtnShow(l: number, cur: number): boolean {\n  return Boolean(l > 3 && cur > 1);\n}\nfunction rightBtnShow(l: number, cur: number): boolean {\n  return Boolean(l > 3 && cur < l - 2);\n}\n\nexport default class Setup extends Component<any, any> {\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      title: '测试进度',\n      currentIndex: null,\n      processCopy: [],\n      process: []\n    }\n  }\n\n  componentWillUpdate(nextProps: any) {\n    console.log('------', nextProps, this.props);\n    if (nextProps.progress !== this.props.progress) {\n      const { progress } = nextProps;\n      this.setState({ processCopy: process }); // 备份（可以不用，props中有数据）\n      this.processSetupData(progress);\n    }\n  }\n\n  arrowClick = (direction: string, isShow: boolean) => {\n    if (!isShow) return;\n    let { currentIndex } = this.state;\n    let { progress } = this.props;\n    console.log('点击箭头', direction, currentIndex);\n    if ( (currentIndex <= 1 && direction === 'left') || (currentIndex >= progress.length - 2 && direction === 'right')) {\n      return;\n    }\n    currentIndex = direction === 'left' ? currentIndex - 1 : currentIndex + 1;  \n    this.setState({ currentIndex }, () => {\n      console.log('修改后的数据', this.state);\n      this.processSetupData(progress);\n    });\n  }\n\n  processSetupData = (list: any[]) => {\n    const setupList = [...list];\n    if (setupList && setupList.length) {\n      let currentIndex = this.state.currentIndex;\n      if (currentIndex === null) {\n        currentIndex = setupList.findIndex((item: any) => item.current === 'Y');\n      }\n      const startIndex: number = currentIndex - 1 < 0 ? 0 : currentIndex - 1;\n      const nowArr = setupList.slice(startIndex, currentIndex + 2);\n      console.log('----处理数据', currentIndex, nowArr);\n      // 根据当前值获取最近数据\n      this.setState({ currentIndex, process: nowArr });\n    }\n  }\n\n  render() {\n    const { process, currentIndex } = this.state;\n    let { progress: progressResouce } = this.props;\n    const leftArrowShaw = leftBtnShow(progressResouce.length, currentIndex);\n    const rightArrowShaw = rightBtnShow(progressResouce.length, currentIndex);\n    return (\n      <div className='setup-wrap'>\n        { <div className={`arrow ${leftArrowShaw ? 'arrow-left' : ''}` } onClick={() => { this.arrowClick('left', leftArrowShaw) }} /> }\n        {/* { progressResouce.length > 3 ? <div className=\"arrow arrow-left\" onClick={() => { this.arrowClick('left') }} /> : null} */}\n        <div className=\"setup-bar\">\n          { process && process.length ? process.map((item: any, idx: number) => {\n            return <SetupItem length={process.length} idx={idx} key={idx} data={item} />\n          }) : null}\n        </div>\n        {/* <div className=\"arrow arrow-right\" onClick={() => { this.arrowClick('right') }} /> */}\n        { <div className={`arrow ${rightArrowShaw ? 'arrow-right' : ''}` } onClick={() => { this.arrowClick('right', rightArrowShaw) }} /> }\n      </div>\n    )\n  }\n}\n"]},"metadata":{},"sourceType":"module"}